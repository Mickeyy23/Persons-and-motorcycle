<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Level HTML Template by Tooplate</title>
    <!-- Load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/datepicker.css" />
    <link rel="stylesheet" href="css/tooplate-style.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <div class="tm-main-content" id="top">
        <div class="tm-top-bar-bg"></div>
        <div class="tm-top-bar" id="tm-top-bar">
            <!-- Top Navbar -->
            <div class="container">
                <div class="row">
                    <nav class="navbar navbar-expand-lg navbar-light">
                        <a class="navbar-brand mr-auto" href="#">
                            <img src="img/moto.jpg" alt="Site logo">
                            Moto Veles
                        </a>
                        <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse"
                            data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                        <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                            <ul class="navbar-nav ml-auto">
                                <li class="nav-item">
                                    <a class="nav-link" href="index.html">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="persons.html">Persons</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="motorcycles.html">Motorcycles</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="motorcycleparty.html">Motorcycle Party</a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>
        <div class="tm-section tm-bg-img" id="tm-section-1">
            <div class="tm-bg-white ie-container-width-fix-2">
                <div class="container ie-h-align-center-fix">
                    <div class="row">
                        <div class="col-xs-12 ml-auto mr-auto ie-container-width-fix">
                            <form id="addPersonForm" class="tm-search-form tm-section-pad-2">
                                <div class="form-row tm-search-form-row">
                                    <div class="form-group tm-form-element tm-form-element-100">
                                        <i class="fa fa-user fa-2x tm-form-element-icon"></i>
                                        <input name="firstName" type="text" class="form-control" id="inputFirstName"
                                            placeholder="Motorcycle Brand">
                                    </div>
                                    <div class="form-group tm-form-element tm-form-element-100">
                                        <i class="fa fa-user fa-2x tm-form-element-icon"></i>
                                        <input name="lastName" type="text" class="form-control" id="inputLastName"
                                            placeholder="Motorcycle Model">
                                    </div>
                                    <div class="form-group tm-form-element tm-form-element-100">
                                        <button id="addPersonButton" class="btn btn-primary tm-btn-search">Add
                                            Motorcycle</button>
                                    </div>
                                    <div class="form-group tm-form-element tm-form-element-100">
                                        <label for="inputYear">Motorcycle Year:</label>
                                        <select class="form-control" id="inputYear" name="year">
                                            <!-- Use JavaScript to dynamically generate years starting from 2024 -->
                                        </select>
                                    </div>
                                    <div class="form-group tm-form-element tm-form-element-100">
                                        <label for="numberField"></label>
                                        <input type="number" class="form-control" id="numberField" readonly>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="tm-section tm-bg-img" id="tm-section-2">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 ml-auto mr-auto">
                    <h2>Motorcycles</h2>
                    <table id="motorcyclesTable" class="table">
                        <thead>
                            <tr>
                                <th>Motorcycle Brand</th>
                                <th>Motorcycle Model</th>
                                <th>Motorcycle Year</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Table rows will be populated dynamically using JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- Load JS files -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/datepicker.min.js"></script>
    <script src="js/jquery.singlePageNav.min.js"></script>
    <script src="slick/slick.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        function setPageNav(){
            if($(window).width() > 991) {
                $('#tm-top-bar').singlePageNav({
                    currentClass:'active',
                    offset: 79
                });   
            }
            else {
                $('#tm-top-bar').singlePageNav({
                    currentClass:'active',
                    offset: 65
                });   
            }
        }

        

    // Function to add a new motorcycle
    async function addMotorcycle() {
    // Your existing code for adding a motorcycle
}

    // Call these functions when the page is loaded
    $(document).ready(function () {
    console.log("Document is ready!");

    $("#addPersonButton").click(function (event) {
        console.log("Button clicked!");
        event.preventDefault();

        // Get the values from the input fields
        var motorcycleBrand = $("#inputFirstName").val();
        var motorcycleModel = $("#inputLastName").val();
        var motorcycleYear = parseInt($("#inputYear").val());

        // Check if all required fields are provided
        if (motorcycleBrand && motorcycleModel && !isNaN(motorcycleYear)) {
            // Create a data object with the form values
            var formData = {
                motorcycle: motorcycleBrand, // Update to "motorcycle"
                motorcycleModel: motorcycleModel,
                year: motorcycleYear
            };

            console.log("Request Payload:", formData);
            // Make an AJAX request to the API endpoint
            $.ajax({
                type: "POST",
                url: "http://localhost:3000/motorcycles/add",
                data: JSON.stringify(formData),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    // Handle the success response (you may want to update the UI accordingly)
                    console.log("Motorcycle added successfully:", response);

                    // Clear the input fields
                    $("#inputFirstName").val("");
                    $("#inputLastName").val("");
                    $("#inputYear").val("");
                    
                // Refresh the page after adding a motorcycle
                location.reload();

                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error("Error adding motorcycle:", textStatus, errorThrown);
                },
                complete: function (jqXHR, textStatus) {
                    console.log("AJAX request complete. Status:", textStatus);
                },
            });
        } else {
            // Handle the case where any required field is not provided
            alert("Please provide all required information for the motorcycle.");
        }
    });
});

// Function to handle the update of a motorcycle
async function editMotorcycle(id) {
    const motorcycle = prompt('Enter new Motorcycle');
    const motorcycleModel = prompt('Enter new Motorcycle Model');
    const year = prompt('Enter new Motorcycle Year');
    console.log("Motorcycle edit function");

    // Check if all required fields are provided
    if (motorcycle && motorcycleModel && year) {
        // Make an AJAX request to the server for updating the motorcycle
        $.ajax({
            type: "PUT",
            url: `http://localhost:3000/motorcycles/${id}`,
            data: JSON.stringify({ motorcycle, motorcycleModel, year }),
            contentType: 'application/json; charset=utf-8',
            dataType: 'json',
            success: function (response) {

                // Handle the success response (you may want to update the UI accordingly)
                console.log("Motorcycle updated successfully:", response);

                location.reload();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                console.error("Error updating motorcycle:", textStatus, errorThrown);
            },
            complete: function (jqXHR, textStatus) {
                console.log("AJAX request complete. Status:", textStatus);
            },
        });
    } else {
        // Handle the case where any required field is not provided
        alert("Please provide all required information for the motorcycle update.");
    }
}
        

    // Function to delete a motorcycle
    // Function to handle the deletion of a motorcycle
    async function deleteMotorcycle(id) {
        const confirmDelete = confirm('Are you sure you want to delete this motorcycle?');
    // Your existing code for deleting a motorcycle
    console.log("Motorcycle ok delete");

    // Example AJAX request to the server
    if (confirmDelete) {
    $.ajax( {
        type: "DELETE",
        url: `http://localhost:3000/motorcycles/${id}`,
        success: function (response) {
            // Handle the success response (you may want to update the UI accordingly)
            console.log("Motorcycle deleted successfully:", response);

            location.reload();
        },
        error: function (jqXHR, textStatus, errorThrown) {
            console.error("Error deleting motorcycle:", textStatus, errorThrown);
        },
        complete: function (jqXHR, textStatus) {
            console.log("AJAX request complete. Status:", textStatus);
        },
    });
}
    // Call this function when the page is loaded
$(document).ready(function () {
    console.log("Document is ready!");
});

    $("#deleteMotorcycleButton").click(function () {
        var motorcycleId = 123; // Replace with the actual ID
        deleteMotorcycle(motorcycleId);
    
});
}

            // Populate the years dropdown with options dynamically
            function populateYearsDropdown() {
                const currentYear = new Date().getFullYear();
                const selectElement = document.getElementById('inputYear');

                for (let year = currentYear; year >= 1900; year--) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.text = year;
                    selectElement.add(option);
                }
            }
            document.addEventListener('DOMContentLoaded', function () {
            // Function to fetch all motorcycles
            async function getMotorcycles() {
                try {
                    const response = await fetch('http://localhost:3000/motorcycles');
                    const motorcycles = await response.json();
                

                    // Display the motorcycles in your table (you need to customize this part)
                    // For example:
                    motorcycles.forEach((motorcycle) => {
                        // Append a new row to the table with motorcycle details
                        // This is just a basic example, you may need to adjust based on your table structure
                        const row = `<tr>
                            <td>${motorcycle.motorcycle}</td>
                            <td>${motorcycle.motorcycleModel}</td>
                            <td>${motorcycle.year}</td>
                            <td>
                                <button onclick="editMotorcycle(${motorcycle.id})">Edit</button>
                                <button onclick="deleteMotorcycle(${motorcycle.id})">Delete</button>
                            </td>
                        </tr>`;
                        document.getElementById('motorcyclesTable').getElementsByTagName('tbody')[0].innerHTML += row;
                    });
                } catch (error) {
                    console.error('Error fetching motorcycles:', error);
                }
            }

            
            // Add an event listener for the "Add Motorcycle" button
            document.getElementById('addPersonButton').addEventListener('click', addMotorcycle);
            // Call the necessary functions on page load
            populateYearsDropdown();
            getMotorcycles();
        });

       
    </script>
</body>

</html>
